<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>å¯ç”¨å¯†é’¥åˆ—è¡¨-å¾®è½¯æ¿€æ´»å¯†é’¥</title>
    <meta name="description" content="MSTOOL - ä¸“ä¸šçš„Windowså’ŒOfficeæ¿€æ´»å·¥å…·ï¼Œæä¾›å¯†é’¥æ£€æµ‹ã€ç¡®è®¤IDè·å–ç­‰å¤šç§å®ç”¨åŠŸèƒ½ã€‚å®‰å…¨å¯é ï¼Œå®Œå…¨å…è´¹ã€‚">
    <meta name="keywords" content="Windowsæ¿€æ´»,Officeæ¿€æ´»,å¯†é’¥æ£€æµ‹,ç¡®è®¤IDè·å–,æ¿€æ´»å·¥å…·,MSTOOL">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="theme-color" content="#409EFF">
    <link rel="stylesheet" href="css/style.css">
</head>
<body data-page="show-keys">
    <a href="#main-content" class="skip-link">è·³è½¬åˆ°ä¸»è¦å†…å®¹</a>
    
    <nav class="nav" role="navigation" aria-label="ä¸»å¯¼èˆª">
        <div class="container">
            <div class="logo" style="text-align: center;">
                MSTOOL
            </div>
            <div style="text-align: center;">
                <ul>
                    <li><a href="index.html">æ£€æµ‹<br>å¯†é’¥</a></li>
                    <li><a href="cid.html">è·å–<br>ID</a></li>
                    <li><a href="show-keys.html" class="active">å¯ç”¨<br>å¯†é’¥</a></li>
                    <li><a href="tool.html">æ¿€æ´»<br>å·¥å…·</a></li>
                    <li><a href="about.html">å…³<br>äº</a></li>
                    <li><a href="build.html">æ­å»º<br>æ•™ç¨‹</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container content" id="main-content">
        <div class="card">
            <div class="card-header">
                å¯ç”¨å¯†é’¥åˆ—è¡¨
                <div style="font-size: 12px; color: #666; margin-top: 5px;">
                    æ¥æºäºäº’è”ç½‘ï¼Œæ²¡æœ‰æ—¶æ•ˆæ€§ï¼Œè¯·æ£€æµ‹åä½¿ç”¨
                </div>
            </div>
            <div class="card-body">
                <!-- æ·»åŠ æœç´¢æ¡† -->
                <div class="search-box">
                    <input type="text" 
                           id="searchInput" 
                           class="form-input" 
                           placeholder="æœç´¢äº§å“æˆ–å¯†é’¥..."
                           aria-label="æœç´¢äº§å“å’Œå¯†é’¥">
                    <div class="search-icon">ğŸ”</div>
                </div>

                <div id="product-list">
                    <!-- äº§å“åˆ—è¡¨å°†é€šè¿‡JavaScriptä»keys.jsonåŠ è½½ -->
                </div>
            </div>
        </div>
    </div>
    
    <footer class="footer">
        <div class="container">
            Â© <span id="current-year"></span> | <a href="https://github.com/lbjlaq/mstool/commit/6914c6432c88b4dc0a4d0c8a72415942a351ad7f">MSTOOL</a>
        </div>
    </footer>

    <div id="loading-indicator" class="loading-indicator" role="status" aria-live="polite" style="display: none;">
        åŠ è½½ä¸­...
    </div>

    <script src="js/main.js"></script>
    <script>
        // è®¾ç½®å¹´ä»½
        document.getElementById('current-year').textContent = new Date().getFullYear();

        // åŠ è½½å¯†é’¥æ•°æ®
        fetch('data/keys.json')
            .then(response => response.json())
            .then(data => {
                const productList = document.getElementById('product-list');
                data.forEach((product, index) => {
                    const availableKeys = product.keys.filter(key => key.activations > 0);
                    const totalKeys = product.keys.length;
                    const availableCount = availableKeys.length;

                    const section = document.createElement('div');
                    section.className = 'product-section';
                    section.innerHTML = `
                        <div class="product-header" onclick="toggleProduct(this)"
                            role="button"
                            aria-expanded="false"
                            aria-controls="product-content-${index}"
                            tabindex="0">
                            <div>
                                ${product.product}
                                <span class="key-count">
                                    (å¯ç”¨: <span class="available-count">${availableCount}</span>/æ€»æ•°: ${totalKeys})
                                </span>
                            </div>
                            <span class="toggle-icon" aria-hidden="true">â–¼</span>
                        </div>
                        <div class="product-content" 
                            id="product-content-${index}"
                            role="region"
                            aria-labelledby="product-header-${index}">
                            <table class="keys-table">
                                <thead>
                                    <tr>
                                        <th>å¯†é’¥</th>
                                        <th>
                                            å¯ç”¨æ¬¡æ•°
                                            <button class="sort-btn" onclick="sortTable(this)" data-order="desc" aria-label="ç‚¹å‡»æŒ‰å¯ç”¨æ¬¡æ•°æ’åº">
                                                <span class="sort-icon">â†“</span>
                                            </button>
                                        </th>
                                        <th>æ›´æ–°æ—¶é—´</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${product.keys.map(key => `
                                        <tr>
                                            <td>${key.key}</td>
                                            <td class="${key.activations > 0 ? 'available' : 'unavailable'}">
                                                ${key.activations}
                                            </td>
                                            <td>${key.time}</td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                    `;
                    productList.appendChild(section);
                });

                // æ·»åŠ æœç´¢åŠŸèƒ½
                const searchInput = document.getElementById('searchInput');
                searchInput.addEventListener('input', function() {
                    const searchTerm = this.value.toLowerCase();
                    const productSections = document.querySelectorAll('.product-section');
                    
                    productSections.forEach(section => {
                        const productHeader = section.querySelector('.product-header');
                        const productTitle = productHeader.textContent.toLowerCase();
                        const rows = section.querySelectorAll('tbody tr');
                        let hasVisibleRows = false;
                        
                        rows.forEach(row => {
                            const key = row.querySelector('td').textContent.toLowerCase();
                            const matchesSearch = productTitle.includes(searchTerm) || 
                                               key.includes(searchTerm);
                            
                            row.style.display = matchesSearch ? '' : 'none';
                            if (matchesSearch) {
                                hasVisibleRows = true;
                            }
                        });
                        
                        section.style.display = hasVisibleRows ? '' : 'none';
                        
                        if (searchTerm && hasVisibleRows) {
                            productHeader.classList.add('active');
                            section.querySelector('.product-content').classList.add('show');
                        }
                    });
                });
            });
    </script>
</body>
</html> 